using System;
using System.Collections.Generic;
using System.IO;
using ELFSharp.ELF;

namespace Mercury.Editor.Models.Compilation;

/// <summary>
/// A structure with information about the result
/// of a compilation process.
/// </summary>
/// <remarks>The <see cref="Dispose"/> method does not
/// clean up <see cref="OutputStream"/> and <see cref="OutputElf"/>
/// if they were generated</remarks>
public readonly struct CompilationResult
{
    /// <summary>
    /// A unique identifier for this compilation. If all the
    /// input files are the same, the identifier will be the same.
    /// </summary>
    public Guid Id { get; init; }
    
    /// <summary>
    /// Whether the compilation was successful or not.
    /// </summary>
    public bool IsSuccess { get; init; }

    /// <summary>
    /// The type of error that ocurred if <see cref="IsSuccess"/> is false.
    /// </summary>
    public CompilationError Error { get; init; }
    
    /// <summary>
    /// A list with all the diagnostics generated by the compilation
    /// </summary>
    public List<Diagnostic>? Diagnostics { get; init; }
    
    /// <summary>
    /// An absolute path to the final compiled binary.
    /// </summary>
    public string? OutputPath { get; init; }
}